@using System.Data;
@using System.Dynamic;
@inject Microsoft​.AspNetCore​.Http.IHttpContextAccessor httpContext;
@{
    ViewData["Title"] = "CDDetails";

    @model PASSForm_BPS.ViewModel.BPSDetailsViewModel

    int presku = 0;
    int prevalue = 0;
    int postsku = 0;
    int postvalue = 0;
    int toggle = 0;
    var poNumber = Model.detailbps.FirstOrDefault()?.PONumber;
    @*============ (Start) Hassam ============*@
    var hcpData = ViewBag.HCPDetails as System.Data.DataTable;
    var hcpDocuments = ViewBag.DOCLIST as System.Data.DataTable;
    var doctorsData = ViewBag.DoctorsData;
    var previousPlans = ViewBag.PreviousPlans;
    var screentype = ViewBag.Screen;
    string roleId = httpContext.HttpContext.Session.GetString("roleid");

    var resultval = new Dictionary<string, List<ExpandoObject>>();
}
<html>
<head>
    <title>Your View</title>
    <style>







        .hide {
            display: none;
        }

        .error-field {
            border: 1px solid red;
            border-radius: 5px;
        }

    </style>
</head>
<body>
<div style="padding-top: 15px;">

    <div style="border: 2px solid; background-color: white; border-radius: 10px; border-color: white; box-shadow: 1px 0px 9px 1px lightgray;">
        <div style="padding-top: 15px;">




            @foreach (var rec in Model.detailbps)
            {

                <div style="padding-top: 15px; padding-left: 20px;">
                    <div class="conatiner">
                        <div class="row">
                            <div class="col-4">

                                <div style="padding-left:3%">
                                    <label style="font-weight:bold;">Teams:</label>

                                    <div style="padding-top: 5px; display:flex;">

                                        @foreach (var T in Model.teams)
                                        {
                                            <div style="border: 2px solid #d71921 ; width: 45%; border-radius: 15px; text-align: center; color: #d71921 ; font-weight:700">

                                                <label id="teamNames" value="@T.TeamName">@T.TeamName</label>
                                            </div>

                                        }

                                    </div>
                                </div>
                            </div>
                            <div class="col-4">


                                <label style="font-weight:bold;">Base Area:</label>
                                <div>
                                    @foreach (var area in Model.requesthcp)
                                    {
                                        <input disabled value="@area.BaseArea" type="text" />
                                    }
                                </div>

                            </div>
                            <div class="col-4">
                                <label style="font-weight:bold;">Distributor:</label>
                                <div>
                                    @foreach (var dis in Model.distributers)
                                    {
                                        <input style="width:95%" disabled value="@dis.DistributerCode - @dis.DistrubiterName" type="text" />
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="padding-top:15px">
                        <div class="container">
                            <div class="row">
                                <div class="col-4">
                                    <label style="font-weight:bold;">Territory Code:</label>
                                    <div>
                                        @foreach (var tmcode in Model.requesthcp)
                                        {
                                            <input disabled value="@tmcode.Tmcode" type="text" />
                                        }
                                    </div>

                                </div>
                                <div class="col-4">
                                    <label style="font-weight:bold;">TM Name:</label>
                                    <div>
                                        @foreach (var usr in Model.users)
                                        {
                                            <input disabled value="@usr.UserName" type="text" />
                                        }
                                    </div>
                                </div>
                                <div class="col-4">
                                    <label style="font-weight:bold;">MacroBrick:</label>
                                    <div>
                                        @foreach (var mac in Model.macrobricks)
                                        {
                                            <input style="width:95%" disabled value="@mac.MacroBrickCode - @mac.MacroBrickName" type="text" />
                                        }
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="padding-top:10px;">
                        <div style="padding-top:10px;">
                            <div class="container">
                                <div class="row">
                                    <div class="col-4">
                                        <label style="font-weight:bold;">Creater Comments:</label><br />
                                        @foreach (var com in Model.detailbps)
                                        {
                                            <textarea disabled id="createcomments" style="width:85%; height:100px; margin-top:1%;">@com.Comments</textarea>

                                        }
                                    </div>
                                    <div class="col-4">

                                        <label style="font-weight:bold;">Doctor Category:</label><br />
                                        @foreach (var dc in Model.requesthcp)
                                        {
                                            <input disabled value="@dc.DoctorsCategory" style="width:100%; height:30px; margin-top:1%;"></input>
                                        }
                                        <form asp-controller="ListView" asp-action="Create" style="padding-left:12px; visibility:hidden;">
                                            <label style="font-weight:bold;">Tracking ID:</label>
                                            <div>
                                                <input readonly style="color:transparent;" asp-for="@rec.TrackingId" id="tracid" value="@rec.TrackingId" type="text" name="inputValue" />
                                                <span asp-validation-for="@rec.TrackingId" class="text-danger"></span>

                                            </div>
                                        </form>

                                    </div>
                                    <div class="col-4">
                                        <label style="font-weight:bold;">FootFall:</label><br />
                                        @foreach (var ft in Model.detailbps)
                                        {
                                            <input disabled value="@ft.FootFall" id="footfall" style="width:100%; height:30px; margin-top:1%;"></input>
                                        }

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>

    <div style="padding-top:20px;">
        <div>
            @foreach (var acc in Model.ChemistCodes)
            {
                @foreach (var cn in Model.chemists)
                {
                    if (cn.ChemistCode == acc)
                    {
                        <button class="accordion">@cn.ChemistName - @acc</button>
                    }

                }
                <div class="panel">
                    <p style="text-align: center; font-weight: bold; font-size: 20px;">Pre-Sales</p>
                    <div>
                        <div style="text-align: center;">
                            <div class="container">
                                <div class="row">
                                    <div class="col-4">
                                        <p style="text-align:right; color: #d71921;">Sale Units</p>
                                    </div>
                                    <div class="col-4">
                                        <div id="toggle-@toggle" class="toggle-switch" onclick="edittoggleSwitchAction(this,@toggle)">
                                            <div class="toggle-slider"></div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <p style="text-align:left; color: #d71921;">Sale Values</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="padding-top:15px;     text-align: center;
    padding-left: 25%;
    padding-bottom: 15px;">
                            <div class="container">
                                <div class="row">
                                    <div class="col-4">
                                        <label>From:</label>
                                        @foreach (var group in Model.preDateRanges.Where(predat => predat.PreTotal != null && predat.Chemist_Code == acc)
                                       .GroupBy(predat => predat.Chemist_Code))
                                        {
                                            var predat = group.First();

                                            <input disabled type="text" value="@(predat.PreFromDate != null ? predat.PreFromDate.Value.ToString("MMM yyyy") : string.Empty)" style="margin-left: 2%; width:60%;" />
                                        }
                                    </div>
                                    <div class="col-4">
                                        <label>To:</label>
                                        @foreach (var group in Model.preDateRanges.Where(predat => predat.PreTotal != null && predat.Chemist_Code == acc)
                                       .GroupBy(predat => predat.Chemist_Code))
                                        {
                                            var predat = group.First();

                                            <input disabled type="text" value="@(predat.PreToDate != null ? predat.PreToDate.Value.ToString("MMM yyyy") : string.Empty)" style="margin-left: 2%; width:70%;" />
                                        }

                                    </div>
                                    <div class="col-4">
                                        @foreach (var predat in Model.preDateRanges)
                                        {
                                            if (predat.PreTotal != null)
                                            {
                                                if (predat.Chemist_Code == acc)
                                                {
                                                    <div>
                                                        <label>Contribution % :</label>
                                                        <input disabled type="number" value="@(predat.Contribution != null ? string.Format("{0:yyyy-MM-dd}", predat.Contribution) : string.Empty)" style="text-align:right; width:40%;" />
                                                    </div>
                                                }
                                            }
                                        }

                                    </div>
                                </div>
                            </div>
                        </div>
                        @foreach (var skupre in Model.SalesUnitsPre)
                        {
                            int cnt = 0;
                            DataTable dt = new DataTable();
                            DataRow dr;
                            @if (skupre.Key == acc)
                            {
                                <div id="sku-@presku" style="overflow:auto;">
                                    <table id="customers">
                                        <thead>
                                            <tr style="    font-size: 10px; background: #d71921; color: white; font-weight: bold;">
                                                @foreach (var skucoloum in skupre.Value[0] as IDictionary<string, object>)
                                                {
                                                    dt.Columns.Add(skucoloum.Key.ToString());
                                           
                                                    if (skucoloum.Key == "ActualDiscount")
                                                    {
                                                        <td>Actual Discount</td>
                                                    }
                                                    else if (skucoloum.Key == "Contribution")
                                                    {
                                                        <td>Contribution</td>
                                                    }
                                                    else if (skucoloum.Key == "PackCode")
                                                    {
                                                        <td>Pack Code</td>
                                                    }
                                                    else if (skucoloum.Key == "ProductName")
                                                    {
                                                        <td>Product Name</td>
                                                    }
                                                    else if (skucoloum.Key == "Description")
                                                    {
                                                        <td>Description</td>
                                                    }
                                                    else
                                                    {



                                                        <td>

                                                            @skucoloum.Key
                                                        </td>

                                                    }

                                                }
                                            </tr>
                                        </thead>
                                        <tbody style="border: 1px solid lightgray;">

                                            @foreach (var skudata in skupre.Value)
                                            {

                                                dt.Clear();
                                                dr = dt.NewRow();
                                                List<string> variance = new List<string>();
                                                <tr style="font-size:10px;">
                                                    @foreach (var skudata1 in skudata)
                                                    {
                                                        if (skudata1.Key == "PackCode")
                                                        {
                                                            dr[skudata1.Key.ToString()] = skudata1.Value;
                                                            <td>@skudata1.Value</td>
                                                        }
                                                        else if (skudata1.Key == "ProductName")
                                                        {
                                                            dr[skudata1.Key.ToString()] = skudata1.Value;
                                                            <td>@skudata1.Value</td>
                                                        }
                                                        else if (skudata1.Key == "Description")
                                                        {
                                                            dr[skudata1.Key.ToString()] = skudata1.Value;
                                                            <td>@skudata1.Value</td>
                                                        }
                                                        else
                                                        {

                                                            dr[skudata1.Key.ToString()] = skudata1.Value;

                                                            <td style="text-align:right;">
                                                                <p>Input_Sales:</p>
                                                                @skudata1.Value
                                                            </td>

                                                        }


                                                   ;
                                                    }
                                                    @{
                                                        dt.Rows.Add(dr);
                                                    }

                                                </tr>
                                                @foreach (var skupre1 in Model.PreeActualAccordionModel)
                                                {
                                                        @if (skupre1.Key == acc)

                                                        {
                                                            <tr style="font-size:10px;">
                                                                @foreach (var skudata1 in skupre1.Value[cnt])
                                                                {

                                                                    if (skudata1.Key == "PackCode")
                                                                    {

                                                                        @*<td>@skudata1.Value</td>*@
                                                                        <td></td>
                                                                    }
                                                                    else if (skudata1.Key == "ProductName")
                                                                    {
                                                                        @*<td>@skudata1.Value</td>*@
                                                                        <td></td>
                                                                    }
                                                                    else if (skudata1.Key == "Description")
                                                                    {
                                                                        @*<td>@skudata1.Value</td>*@
                                                                        <td></td>
                                                                    }
                                                                    else
                                                                    {

                                                                        double varian = Convert.ToDouble(skudata1.Value) - Convert.ToDouble(dt.Rows[0].Field<string>(skudata1.Key));
                                                                        variance.Add(varian.ToString());
                                                                        <td style="text-align:right;">
                                                                            <p>Actual_Sales:</p>
                                                                            @skudata1.Value
                                                                        </td>

                                                                    }


                                                                }
                                                            </tr>

                                                            <tr style="font-size:10px;">
                                                                @{
                                                                    int i = 0;
                                                                }
                                                                @foreach (var skudata1 in skupre1.Value[cnt])
                                                                {

                                                                    if (skudata1.Key == "PackCode")
                                                                    {
                                                                        <td></td>
                                                                        @*<td>@skudata1.Value</td>*@
                                                                    }
                                                                    else if (skudata1.Key == "ProductName")
                                                                    {
                                                                        <td></td>
                                                                        @*<td>@skudata1.Value</td>*@
                                                                    }
                                                                    else if (skudata1.Key == "Description")
                                                                    {
                                                                        <td></td>
@*                                                                        <td>@(
                                                                              skudata1.Value + " Variance "
                                                                         )</td>*@
                                                                    }
                                                                    else
                                                                    {


                                                                        <td style="text-align:right;">
                                                                           <p>Variance:</p>
                                                                           @variance[i];
                                                                        </td>

                                                                        i++;


                                                                    }


                                                                }
                                                            </tr>
                                                        }
                                                    }
                                                cnt++;
                                            }

                                        </tbody>
                                    </table>
                                </div>
                            }
                        }

                        @foreach (var valpre in Model.SalesValuesPre)
                        {
                            int cnt = 0;
                            DataTable dt = new DataTable();
                            DataRow dr;
                            @if (valpre.Key == acc)
                            {
                                <div id="value-@prevalue" style="overflow:auto; display:none">
                                    <table id="customers">
                                        <thead>
                                            <tr style="   font-size: 10px; background: #d71921; color: white; font-weight: bold;">
                                                @foreach (var valuecolumn in valpre.Value[0] as IDictionary<string, object>)
                                                {
                                                    dt.Columns.Add(valuecolumn.Key.ToString());
                                                    if (valuecolumn.Key == "ActualDiscount")
                                                    {
                                                        <td>Actual Discount</td>
                                                    }
                                                    else if (valuecolumn.Key == "Contribution")
                                                    {
                                                        <td>Contribution</td>
                                                    }
                                                    else if (valuecolumn.Key == "PackCode")
                                                    {
                                                        <td>Pack Code</td>
                                                    }
                                                    else if (valuecolumn.Key == "ProductName")
                                                    {
                                                        <td>Product Name</td>
                                                    }
                                                    else if (valuecolumn.Key == "Description")
                                                    {
                                                        <td>Description</td>
                                                    }
                                                    else
                                                    {



                                                        <td>

                                                            @valuecolumn.Key
                                                        </td>

                                                    }
                                                }
                                            </tr>
                                        </thead>
                                        <tbody style="border: 1px solid lightgray;">

                                            @foreach (var valdata in valpre.Value)
                                            {

                                                dt.Clear();
                                                dr = dt.NewRow();
                                                List<string> variance = new List<string>();
                                                <tr style="font-size:10px;">
                                                    @foreach (var valdata1 in valdata)
                                                    {
                                                        if (valdata1.Key == "PackCode")
                                                        {
                                                            dr[valdata1.Key.ToString()] = valdata1.Value;
                                                            <td>@valdata1.Value</td>
                                                        }
                                                        else if (valdata1.Key == "ProductName")
                                                        {
                                                            dr[valdata1.Key.ToString()] = valdata1.Value;
                                                            <td>@valdata1.Value</td>
                                                        }
                                                        else if (valdata1.Key == "Description")
                                                        {
                                                            dr[valdata1.Key.ToString()] = valdata1.Value;
                                                            <td>@valdata1.Value</td>
                                                        }
                                                        else
                                                        {


                                                            dr[valdata1.Key.ToString()] = valdata1.Value;
                                                            <td class="Comma" style="text-align:right;">
                                                                <p>Input_Sales:</p>
                                                                 @valdata1.Value
                                                            </td>

                                                        }

                                                    }
                                                    @{
                                                        dt.Rows.Add(dr);
                                                    }
                                                </tr>
                                                @foreach (var acvalpre1 in Model.PreeActualAccordionModelValues)
                                                {
                                                    // for (int i = 0; i < skupre1.Value.Count(); i++)
                                                    @if (acvalpre1.Key == acc)
                                                    {
                                                        <tr style="font-size:10px;">
                                                            @foreach (var valdata1 in acvalpre1.Value[cnt])
                                                            {

                                                                if (valdata1.Key == "PackCode")
                                                                {

                                                                    @*<td>@valdata1.Value</td>*@
                                                                    <td></td>
                                                                }
                                                                else if (valdata1.Key == "ProductName")
                                                                {
                                                                    @*<td>@valdata1.Value</td>*@
                                                                    <td></td>
                                                                }
                                                                else if (valdata1.Key == "Description")
                                                                {
                                                                    @*<td>@valdata1.Value</td>*@
                                                                    <td></td>
                                                                }
                                                                else
                                                                {

                                                                    double varian = Convert.ToDouble(valdata1.Value) - Convert.ToDouble(dt.Rows[0].Field<string>(valdata1.Key));
                                                                    variance.Add(varian.ToString());
                                                                    <td style="text-align:right;">
                                                                        <p>Actual_Sales:</p>
                                                                       @valdata1.Value
                                                                    </td>

                                                                }


                                                            }
                                                        </tr>
                                                        <tr style="font-size:10px;">
                                                            @{
                                                                int i = 0;
                                                            }
                                                            @foreach (var valdata1 in acvalpre1.Value[cnt])
                                                            {

                                                                if (valdata1.Key == "PackCode")
                                                                {

                                                                    @*<td>@valdata1.Value</td>*@
                                                                    <td></td>
                                                                }
                                                                else if (valdata1.Key == "ProductName")
                                                                {
                                                                    @*<td>@valdata1.Value</td>*@
                                                                    <td></td>
                                                                }
                                                                else if (valdata1.Key == "Description")
                                                                {
                                                                    @*<td>@(valdata1.Value + " Variance ")</td>*@
                                                                    <td></td>
                                                                }
                                                                else
                                                                {


                                                                    <td style="text-align:right">
                                                                   @*     <input disabled style="text-align:right; width:85%" type="text"  value="">*@
                                                                       <p>Variance:</p>
                                                                         @variance[i]
                                                                    </td>

                                                                    i++;


                                                                }


                                                            }
                                                        </tr>
                                                    }


                                                }
                                                cnt++;
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            }
                        }
                        <div>
                            <div style="text-align:right; margin-top:2%;">
                                <label>Chemist Total(Rs):</label>


                                @foreach (var group in Model.preDateRanges.Where(predat => predat.PreTotal != null && predat.Chemist_Code == acc)
                               .GroupBy(predat => predat.Chemist_Code))
                                {
                                    var predat = group.First();

                                    <input disabled type="text" class="allinput-fields" value="@(predat.PreTotal != null ? string.Format("{0:yyyy-MM-dd}", predat.PreTotal) : string.Empty)" style="margin-left: 2%;" />
                                }

                            </div>
                            <div style="text-align:right; margin-top:2%; visibility:hidden;">
                                <label>Discount Percentage %:</label>


                                @foreach (var group in Model.preDateRanges.Where(predat => predat.PreTotal != null && predat.Chemist_Code == acc)
                               .GroupBy(predat => predat.Chemist_Code))
                                {
                                    var predat = group.First();

                                    <input disabled type="text" class="allinput-fields" value="@(predat.discountpercentage != null ? string.Format("{0:yyyy-MM-dd}", predat.discountpercentage) : string.Empty)" style="margin-left: 2%;" />
                                }

                            </div>
                        </div>

                    </div>

                    <p style="text-align: center; font-weight: bold; font-size: 20px;">Post-Sales</p>

                    <div style="text-align: center;">
                        <div class="container">
                            <div class="row">
                                <div class="col-4">
                                    <p style="text-align:right; color: #d71921;">Sale Units</p>
                                </div>
                                <div class="col-4">
                                    <div id="toggle-@toggle" class="toggle-switch" onclick="editposttoggleSwitchAction(this,@toggle)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <p style="text-align:left; color: #d71921;">Sale Values</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="padding-top:15px; text-align:center;     padding-left: 25%;
    padding-bottom: 15px;">
                        <div class="container">
                            <div class="row">
                                <div class="col-4">
                                    <label>From:</label>
                                    @foreach (var group in Model.postDateRanges.Where(predat => predat.PostTotal != null && predat.Chemist_Code == acc)
                                   .GroupBy(predat => predat.Chemist_Code))
                                    {
                                        var predat = group.First();

                                        <input disabled type="text" value="@(predat.PostFromDate != null ? predat.PostFromDate.Value.ToString("MMM yyyy") : string.Empty)" style="margin-left: 2%; width:60%;" />
                                    }
                                </div>
                                <div class="col-4">
                                    <label>To:</label>
                                    @foreach (var group in Model.postDateRanges.Where(predat => predat.PostTotal != null && predat.Chemist_Code == acc)
                                   .GroupBy(predat => predat.Chemist_Code))
                                    {
                                        var predat = group.First();

                                        <input disabled type="text" value="@(predat.PostToDate != null ? predat.PostToDate.Value.ToString("MMM yyyy") : string.Empty)" style="margin-left: 2%; width:70%;" />
                                    }

                                </div>
                                <div class="col-4">


                                </div>
                            </div>
                        </div>
                    </div>
                    @foreach (var skupre in Model.SalesUnitsPost)
                    {
                        @if (skupre.Key == acc)
                        {
                            <div id="postsku-@presku" style="overflow:auto;">
                                <table id="customers">
                                    <thead>
                                        <tr style="    font-size: 10px; background: #d71921; color: white; font-weight: bold;">
                                            @foreach (var skucoloum in skupre.Value[0] as IDictionary<string, object>)
                                            {
                                                if (skucoloum.Key == "ActualDiscount")
                                                {
                                                    <td>Actual Discount</td>
                                                }
                                                else if (skucoloum.Key == "Contribution")
                                                {
                                                    <td>Contribution</td>
                                                }
                                                else if (skucoloum.Key == "PackCode")
                                                {
                                                    <td>Pack Code</td>
                                                }
                                                else if (skucoloum.Key == "ProductName")
                                                {
                                                    <td>Product Name</td>
                                                }
                                                else if (skucoloum.Key == "Description")
                                                {
                                                    <td>Description</td>
                                                }
                                                else
                                                {



                                                    <td>

                                                        @skucoloum.Key
                                                    </td>

                                                }

                                            }
                                        </tr>
                                    </thead>
                                    <tbody>

                                        @foreach (var skudata in skupre.Value)
                                        {
                                            <tr style="font-size:10px;">
                                                @foreach (var skudata1 in skudata)
                                                {
                                                    if (skudata1.Key == "PackCode")
                                                    {
                                                        <td>@skudata1.Value</td>
                                                    }
                                                    else if (skudata1.Key == "ProductName")
                                                    {
                                                        <td>@skudata1.Value</td>
                                                    }
                                                    else if (skudata1.Key == "Description")
                                                    {
                                                        <td>@skudata1.Value</td>
                                                    }
                                                    else
                                                    {



                                                        <td style="text-align:right;">

                                                            @skudata1.Value
                                                        </td>

                                                    }


                                                }
                                            </tr>

                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                    }
                    @foreach (var valpre in Model.SalesValuesPost)
                    {
                        @if (valpre.Key == acc)
                        {
                            <div id="postvalue-@prevalue" style="overflow:auto; display:none">
                                <table id="customers">
                                    <thead>
                                        <tr style="   font-size: 10px; background: #d71921; color: white; font-weight: bold;">
                                            @foreach (var valuecolumn in valpre.Value[0] as IDictionary<string, object>)
                                            {

                                                if (valuecolumn.Key == "ActualDiscount")
                                                {
                                                    <td>Actual Discount</td>
                                                }
                                                else if (valuecolumn.Key == "Contribution")
                                                {
                                                    <td>Contribution</td>
                                                }
                                                else if (valuecolumn.Key == "PackCode")
                                                {
                                                    <td>Pack Code</td>
                                                }
                                                else if (valuecolumn.Key == "ProductName")
                                                {
                                                    <td>Product Name</td>
                                                }
                                                else if (valuecolumn.Key == "Description")
                                                {
                                                    <td>Description</td>
                                                }
                                                else
                                                {



                                                    <td>

                                                        @valuecolumn.Key
                                                    </td>

                                                }
                                            }
                                        </tr>
                                    </thead>
                                    <tbody>

                                        @foreach (var valdata in valpre.Value)
                                        {
                                            <tr style="font-size:10px;">
                                                @foreach (var valdata1 in valdata)
                                                {
                                                    if (valdata1.Key == "PackCode")
                                                    {
                                                        <td>@valdata1.Value</td>
                                                    }
                                                    else if (valdata1.Key == "ProductName")
                                                    {
                                                        <td>@valdata1.Value</td>
                                                    }
                                                    else if (valdata1.Key == "Description")
                                                    {
                                                        <td>@valdata1.Value</td>
                                                    }
                                                    else
                                                    {



                                                        <td class="Comma" style="text-align:right;">

                                                            @valdata1.Value
                                                        </td>

                                                    }

                                                }
                                            </tr>

                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                    }
                    <div>
                        <div style="text-align:right; margin-top:2%;">
                            <label>Chemist Total(Rs):</label>


                            @foreach (var group in Model.postDateRanges.Where(predat => predat.PostTotal != null && predat.Chemist_Code == acc)
                           .GroupBy(predat => predat.Chemist_Code))
                            {
                                var predat = group.First();

                                <input disabled type="text" class="allinput-fields" value="@(predat.PostTotal != null ? string.Format("{0:yyyy-MM-dd}", predat.PostTotal) : string.Empty)" style="margin-left: 2%;" />
                            }

                        </div>
                        <div style="text-align:right; margin-top:2%;">
                            <label>Discount Percentage %:</label>


                            @foreach (var group in Model.postDateRanges.Where(predat => predat.PostTotal != null && predat.Chemist_Code == acc)
                           .GroupBy(predat => predat.Chemist_Code))
                            {
                                var predat = group.First();

                                <input disabled type="text" class="allinput-fields" value="@(predat.discountpostcentage != null ? string.Format("{0:yyyy-MM-dd}", predat.discountpostcentage) : string.Empty)" style="margin-left: 2%;" />
                            }

                        </div>
                    </div>




                </div>

                presku++;
                prevalue++;
                postsku++;
                postvalue++;
                toggle++;
            }
            <div>
                <div style="text-align:right; margin-top:2%;">
                    <label>Total Without Discount:</label>


                    @foreach (var totalwithoutdiscount in Model.customersmodels.Where(totalwithoutdiscount => totalwithoutdiscount.totalwithoutdiscount != null)
                    .GroupBy(totalwithoutdiscount => totalwithoutdiscount.totalwithoutdiscount))
                    {
                        var predat = totalwithoutdiscount.First(); // Take the first item in each group

                        <input disabled type="text" class="allinput-fields" value="@(predat.totalwithoutdiscount != null ? predat.totalwithoutdiscount : string.Empty)" style="margin-left: 2%;" />
                    }

                </div>
            </div>

            <div>
                <div style="text-align:right; margin-top:3%;">
                    <label>Total With Discount:</label>


                    @foreach (var totalwithdiscount in Model.customersmodels.Where(totalwithdis => totalwithdis.totalwithdiscount != null)
                    .GroupBy(totalwithdiscount => totalwithdiscount.totalwithdiscount))
                    {
                        var predat = totalwithdiscount.First(); // Take the first item in each group

                        <input disabled type="text" class="allinput-fields" value="@(predat.totalwithdiscount != null ? predat.totalwithdiscount : string.Empty)" style="margin-left: 2%;" />
                    }

                </div>
            </div>

            <div>
                <div style="text-align:right; margin-top:2%;">
                    <label>BPS Percentage %:</label>


                    @foreach (var bpsperc in Model.customersmodels.Where(bpsperc => bpsperc.bpspercentage != null)
                    .GroupBy(bpsperc => bpsperc.bpspercentage))
                    {
                        var predat = bpsperc.First(); // Take the first item in each group

                        <input disabled type="text" class="allinput-fields" value="@(predat.bpspercentage != null ? predat.bpspercentage : string.Empty)" style="margin-left: 2%;" />
                    }

                </div>
            </div>

            <div>
                <div style="text-align:right; margin-top:2%;">
                    <label>NET Percentage %:</label>


                    @foreach (var roi in Model.customersmodels.Where(roi => roi.totalroipercentage != null)
                    .GroupBy(roi => roi.totalroipercentage))
                    {
                        var predat = roi.First(); // Take the first item in each group

                        <input disabled type="text" class="allinput-fields" value="@(predat.totalroipercentage != null ? predat.totalroipercentage : string.Empty)" style="margin-left: 2%;" />
                    }

                </div>
            </div>
        </div>
    </div>

    <div>
        <label style="font-weight:bold; @((roleId == "16" && poNumber != null) ? "display:none;" : "")">Comments:</label><br />
        <textarea id="comments" style="width:60%; height:100px; margin-top:1%; @((roleId == "16" && poNumber != null) ? "display:none;" : "")"></textarea><br>
        <label class="hide" id="CommentsErrorLabel" style="color:red;font-size:10px;">Required! Please Enter Comments</label>
        <input type="text" style="visibility:hidden;" id="wlstid" value="@ViewBag.WorklistId"></input>
    </div>

    <div style="text-align:center; padding-top:3%;">
        <input id="approvebps" type="button" class="btn btn-primary" value="Approve" onclick="BpsApproval()" />

        <input id="pbjectionbps" type="button" class="btn btn-danger" value="Objection" onclick="BpsObjection()" />

    </div>


</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="~/js/datatable_file.js"></script>
<script src="~/js/modal.js"></script>

<script>
    var acc = document.getElementsByClassName("accordion");
    var i;

    for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function () {
            this.classList.toggle("active");
            var panel = this.nextElementSibling;
            if (panel.style.maxHeight) {
                panel.style.maxHeight = null;
            } else {
                panel.style.maxHeight = panel.scrollHeight + "%";
            }
        });
    }
</script>

</body>

</html>